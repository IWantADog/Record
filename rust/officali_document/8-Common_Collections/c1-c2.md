# Chapter 8 Common Collections

## Storing Lists of Values with Vectors

关于`vectors`

### 特性

1. 只能存储相同的数据类型。
2. 数据在内存中是相邻存在的。

### how to use

#### create

```rs
let v: Vec<i32> = Vec::new();

let v = vec![1, 2, 3];

```

#### update

```rs
let mut v = Vec::new();

v.push(5);
v.push(6);
v.push(7);
v.push(8);
```

#### read

支持通过游标和`get`获取。通过游标获取时，如果游标出界会报错。通过`get`获取，如果游标出界，返回`None`。

__不能同时拥有`mutable`和`immutable` reference。__

```rust
let v = vec![1, 2, 3, 4, 5];

let does_not_exist = &v[2];
let does_not_exist = v.get(2);
```

#### Iterating over the Values in a Vector

使用`for`遍历

```rust
// 遍历
let v = vec![100, 32, 57];
for i in &v {
    println!("{}", i);
}

// 遍历并修改
let mut v = vec![100, 32, 57];
for i in &mut v {
    *i += 50;
}
```

`*`: `dereference operator`。（感觉就是c）

#### Using an Enum to Store Multiple Types

`enum`中的单项被视为相同的类型。可以存放在vector中。

```rust
enum SpreadsheetCell {
    Int(i32),
    Float(f64),
    Text(String),
}

let row = vec![
    SpreadsheetCell::Int(3),
    SpreadsheetCell::Text(String::from("blue")),
    SpreadsheetCell::Float(10.12),
];
```

https://doc.rust-lang.org/std/vec/struct.Vec.html


## Storing UTF-8 Encoded Text with Strings

### What Is a String?

注意区分`str`和`String`。

`str`: 是rust内部使用的唯一字符串类型

`String`: 是rust的标准库，提供了可变的，utf-8编码的字符串类型。

### create a string

创建String对象有两种方式。
- `String::from()`
- `"this is a string".to_string()`

### update a string

修改`String`对象的方式：
- `String::push_str()`: 向`String`中增加字符串。
- `String::push()`: 向`String`中增加单个字符。
- 使用`+`连接`String`对象。
    ```rust
    let s1 = String::from("Hello, ");
    let s2 = String::from("world!");
    let s3 = s1 + &s2;
    ```

    不过使用`+`连接`String`对象之后，s1对象就不可用了。其实相当于`let s3 = s1.add(&s2)`。s3获取了ownership，所以s1不可用了。

- 使用`format!("{}", data)`。这种方式比较直观，并且不会获取任何对象的`ownership`。

### index to Strings

rust __不支持__ 通过游标获取`String`对象中的某个字符。

`String`是`Vec<u8>`的包装。`String`的长度是将数据使用`utf-8`编码之后的长度，对于有些语言，一个字占用了两个字节。所以使用下标，会导致获取数据时出问题。为了避免这样的问题，rust直接不支持通过下标获取字符串中的字符。

### slicing Strings

rust中可以通过切片的形式获取部分字符串。不过还是会有不同语言每个字占用的字节数不固定的问题。

```rust
let a = "12345678"
let s = &a[1..2]

let hello = "Здравствуйте";
let s = &hello[0..4]; // 这里s没有问题

let s1 = $hello[0..3]; // 这里就有问题了
```

### iterating over Strings

迭代`str`的两种方法：
- `str.chars()`: 每次返回一个单独的`unicdoe scalar value`。
- `str.bytes()`: 每次迭代返回单个字节。