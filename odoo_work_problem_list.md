# 工作中odoo遇到的问题记录

## form视图返回tree视图的问题

问题：第一次从tree视图返回到form视图时结果是正确的。当第一次返回到tree视图后，再次点击进入form视图并返回tree视图就会出错。

原因：

第一次结果正确，是我加的代码生效了。第二期结果出错了，是因为位于tree时虽然页面展示正确当js内存中的数据的current_min为1，所以当第二次返回时

尝试：

1. ~~向通过直接重定向url的方式，跳转到正确页面。~~

    失败。原因是url中的关键参数都存放在‘#’后面，浏览器对于这样的url不会重新加载页面，而只会将其压入history。

2. ~~通过history.back()。在合适位置回退一次历史记录。~~

    失败。执行回退之后，js方法依然会加载后续方法，无法控制。具体表现为第一次回退成功，第二次会出现类型回退了两次的问题。

3. 在原来的代码修改基础上，增加修改`view.current_min=emp_current_min[model.type]`后解决问题🎉🎉🎉。

    不过我并没有搞清楚为什么会这样。为什么修改view.current_min会使页面显示正确。以及顺带修复了回退第二次时才能正确回退的问题。
